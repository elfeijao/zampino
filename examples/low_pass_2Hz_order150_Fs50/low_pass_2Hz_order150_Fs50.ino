#include <zampino.h>

#define PIN_SENSOR A0
#define FS 50
#define TS (1000/FS)

float b[] = { -7.779954602463449e-05,-0.0001601487287105385,-0.0002379015768321947,-0.0003079444862141195,-0.0003667004041114149,-0.0004100984786583931,-0.0004336801191211769,-0.000432857775891459,-0.0004033230699371255,-0.0003415797423460158,-0.0002455564782219098,-0.0001152372653506449,4.676530459106405e-05,0.000234773751531303,0.0004398236978484784,0.0006497221508311168,0.0008494326303180962,0.001021807148974385,0.001148653322547722,0.001212090510904892,0.001196114855135596,0.001088262580173619,0.0008812371149975751,0.0005743512409280783,0.0001746328003842055,-0.0003025471704681026,-0.0008334413511706997,-0.001386569327963139,-0.001924071431069383,-0.002403753010081236,-0.002781740486329158,-0.003015612620329527,-0.003067817809847016,-0.002909145548180713,-0.002521991636415802,-0.001903145763006082,-0.001065838917050738,-4.081768970378093e-05,0.001123737788022108,0.002363567928111503,0.003600993656607858,0.004748825170172794,0.005715368244159308,0.00641028619776611,0.006750995217381419,0.006669207036921495,0.006117191590693834,0.005073317526033553,0.003546443066904281,0.00157877440107611,-0.0007531178088752874,-0.003339334424939284,-0.006039828210568066,-0.008689688655838147,-0.01110635468343898,-0.0130984460697868,-0.0144757848440663,-0.01506007985919606,-0.01469567852714486,-0.01325975508817099,-0.01067130835471355,-0.006898384844214513,-0.001963024239285795,0.004056460704980051,0.01102611458984455,0.01875996214093145,0.02702653257629096,0.03555802272965993,0.0440616754063944,0.05223281047650386,0.05976883801686336,0.06638351266381078,0.0718206611720786,0.07586663327142466,0.07836078869651193,0.07920343732992524,0.07836078869651193,0.07586663327142466,0.07182066117207858,0.06638351266381078,0.05976883801686334,0.05223281047650388,0.04406167540639441,0.03555802272965993,0.02702653257629096,0.01875996214093145,0.01102611458984455,0.004056460704980055,-0.001963024239285797,-0.006898384844214513,-0.01067130835471355,-0.01325975508817099,-0.01469567852714486,-0.01506007985919606,-0.0144757848440663,-0.0130984460697868,-0.01110635468343898,-0.008689688655838147,-0.006039828210568068,-0.003339334424939281,-0.0007531178088752848,0.00157877440107611,0.003546443066904282,0.005073317526033552,0.006117191590693836,0.006669207036921499,0.006750995217381419,0.006410286197766111,0.005715368244159308,0.004748825170172797,0.003600993656607858,0.002363567928111503,0.001123737788022108,-4.0817689703781e-05,-0.001065838917050738,-0.001903145763006082,-0.002521991636415804,-0.002909145548180715,-0.003067817809847017,-0.003015612620329528,-0.002781740486329159,-0.002403753010081238,-0.001924071431069384,-0.001386569327963139,-0.0008334413511706993,-0.0003025471704681024,0.0001746328003842051,0.000574351240928078,0.0008812371149975766,0.00108826258017362,0.001196114855135598,0.001212090510904893,0.001148653322547723,0.001021807148974386,0.0008494326303180975,0.0006497221508311175,0.0004398236978484795,0.0002347737515313039,4.676530459106335e-05,-0.0001152372653506449,-0.0002455564782219102,-0.0003415797423460162,-0.0004033230699371256,-0.0004328577758914588,-0.0004336801191211774,-0.0004100984786583932,-0.0003667004041114149,-0.0003079444862141195,-0.0002379015768321947,-0.0001601487287105385,-7.779954602463442e-05 };
float a[] = { 1 };

Filter filter;

void setup(){

    uint16_t baudrate = 9600;
    Serial.begin( baudrate, SERIAL_8N1 );
    
    filter.coef(  b, sizeof(b)/sizeof(float), 
                  a, sizeof(a)/sizeof(float) );

}


void loop(){

  float x = analogRead( PIN_SENSOR );
  float filtered = filter.fir( x );
  Serial.print(x);
  Serial.print(",");
  Serial.println(filtered);

  delay( TS );
}
